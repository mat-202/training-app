<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة تحدي القراءة الموحد</title>
    
    <style>
        body {
            font-family: Tahoma, Arial, sans-serif;
            background-color: #f7f9fc; 
            direction: rtl; 
            text-align: right;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            border: 1px solid #ddd;
        }

        h1 {
            color: #1a73e8; 
            font-size: 28px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .section-box {
            border: 2px solid #34a853; 
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .section-box h2 {
            color: #34a853;
            margin-top: 0;
            font-size: 22px;
            border-bottom: 1px solid #dcdcdc;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        /* حقول الإدخال والقوائم المنسدلة */
        .form-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap; 
        }

        .form-group label {
            font-weight: bold;
            color: #555;
            min-width: 120px;
            margin-left: 10px;
        }

        .form-group input, .form-group select {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            min-width: 150px;
            background-color: white; 
        }
        
        /* تنسيق الأزرار المشابهة للقوائم المنسدلة */
        .select-like-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .select-like-group button {
            padding: 10px 15px;
            border: 1px solid #a0a0a0;
            border-radius: 5px;
            background-color: #f0f0f0;
            cursor: pointer;
            font-size: 16px;
            color: #333;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .select-like-group button.selected {
            background-color: #fce3a7; 
            border-color: #ffc107;
            font-weight: bold;
            color: #333;
        }

        /* زر بدء التدريب */
        #start-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 25px;
            border: none;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            color: white;
            background-color: #1a73e8; 
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #start-button:hover {
            background-color: #0d5dd1;
        }
        
        /* شاشة التحدي الفعلية */
        #quiz-display {
            display: none;
            width: 100%;
            text-align: center;
        }
        
        #quiz-display h1 {
             color: #34a853; 
        }

        .word-box {
            background-color: #fff9e6; 
            border: 4px solid #ffc107; 
            padding: 70px 30px;
            min-height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        /* ** التعديلات الرئيسية للتقسيم ** */
        #current-item {
            font-weight: 900;
            color: #333333;
            margin: 0;
            line-height: 1.5;
            display: flex; 
            align-items: stretch; 
            justify-content: center; 
            width: 100%; 
            height: 100%; 
            padding: 0;
            /* عكس الترتيب (الرقم في اليمين، الكلمة في اليسار) */
            flex-direction: row-reverse; 
        }

        .item-segment {
            flex-grow: 0; 
            display: flex;
            align-items: center; 
            justify-content: center; 
            font-size: 70px; 
            /* لتقريب الفاصل */
            padding-left: 15px; 
            padding-right: 15px;
        }
        
        /* الجزء الأيمن (الرقم): */
        .item-number {
            /* إضافة فاصل على اليسار */
            border-left: 3px solid #ffc107; 
        }
        
        /* مؤقت الشريط */
        #timer-bar {
            position: absolute;
            bottom: 0;
            right: 0; 
            width: 100%;
            height: 15px;
            background-color: #ffc107; 
            transform-origin: right; 
        }
        
        /* زر العودة */
        .back-btn {
            background-color: #f44336; 
            color: white; 
            padding: 10px 20px; 
            border: none;
            border-radius: 5px; 
            font-size: 16px; 
            margin-top: 20px;
            cursor: pointer;
        }
        
    </style>
</head>
<body>
    <div class="container">
        
        <div id="setup-screen">
            <h1>منصة تحدي القراءة الموحد</h1>
            
            <div class="section-box">
                <h2>التدريب المتقدم</h2>
                
                <div class="form-group">
                    <label for="trainee-name">اسم المتدرب:</label>
                    <input type="text" id="trainee-name" placeholder="اكتب اسم المتدرب">
                </div>
                
                <div class="form-group">
                    <label for="start-index">البدء من الرقم:</label>
                    <input type="number" id="start-index" value="1" min="1" max="500" style="width: 100px; text-align: center;">
                    <span id="max-index-tip" style="color: #888; margin-right: 15px;">(الحد الأقصى: 500)</span>
                </div>
                
                <div class="form-group" id="group-selection-container">
                    <label for="group-select" id="group-select-label">اختيار المجموعة:</label>
                    <select id="group-select">
                        <option value="all_words">جميع الكلمات (500 كلمة)</option>
                        <option value="group_1">المجموعة 1: الأفعال الماضية الأساسية (50 كلمة)</option>
                        <option value="group_2">المجموعة 2: الأسماء الأساسية (50 كلمة)</option>
                        <option value="group_3">المجموعة 3: المدود والحركات الطويلة (50 كلمة)</option>
                        <option value="group_4">المجموعة 4: التنوين والشدة واللامات (50 كلمة)</option>
                        <option value="group_5">المجموعة 5: الضمائر والأسماء الموصولة (50 كلمة)</option>
                        <option value="group_6">المجموعة 6: الأرقام والترتيب (50 كلمة)</option>
                        <option value="group_7">المجموعة 7: الصفات والألوان الأساسية (50 كلمة)</option>
                        <option value="group_8">المجموعة 8: ظروف الزمان والمكان (50 كلمة)</option>
                        <option value="group_9">المجموعة 9: أسماء الأقارب والمهن (50 كلمة)</option>
                        <option value="group_10">المجموعة 10: أدوات الاستفهام والتعابير الشائعة (50 كلمة)</option>
                        </select>
                </div>
                
                <div style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
                    
                    <div style="flex: 1; min-width: 150px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px;">المستوى الأول:</label>
                        <div class="select-like-group" id="level-selection-group">
                            <button data-level="words" data-max="500" class="selected">الكلمات (500)</button>
                            <button data-level="sentences" data-max="200">الجمل (200)</button>
                        </div>
                    </div>

                    <div style="flex: 1; min-width: 150px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px;">القسم:</label>
                        <div class="select-like-group">
                             <button style="background-color: #e6e6e6; cursor: default;">الإحصاء (برج جدول وسيط)</button>
                        </div>
                    </div>
                    
                    <div style="flex: 1; min-width: 180px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px;">المدة الزمنية:</label>
                        <div class="select-like-group" id="duration-selection-group">
                            <button data-duration="1000">1 ثانية</button>
                            <button data-duration="2000">2 ثواني</button>
                            <button data-duration="3000">3 ثواني</button>
                            <button data-duration="5000" class="selected">5 ثواني</button>
                            <button data-duration="10000">10 ثواني</button>
                            <button data-duration="20000">20 ثانية</button>
                            <button data-duration="30000">30 ثانية</button>
                        </div>
                    </div>
                </div>

                <p style="margin-top: 30px; text-align: center; font-size: 14px; color: #777;">إعداد الأستاذ عبدالعزيز الحجيلي</p>

            </div>
            
            <button id="start-button" onclick="validateAndStartQuiz()">اضغط لبدء التدريب</button>

            <p id="error-message" style="color: red; text-align: center; margin-top: 15px; font-weight: bold; display: none;"></p>
        </div>

        <div id="quiz-display">
            <h1 id="quiz-title"></h1>
            
            <div id="item-display" class="word-box">
                <div id="current-item">
                    <div class="item-segment item-content">جاري البدء...</div>
                    <div class="item-segment item-number"></div>
                </div>
                <div id="timer-bar"></div>
            </div>
            
            <p style="font-size: 20px; color: #555;">ستتغير النصوص تلقائيًا كل <span id="time-display"></span> ثوانٍ.</p>
            
            <button class="back-btn" onclick="location.reload()">العودة لصفحة الإعدادات</button>
        </div>
    </div>
    
    <script>
        // **********************************************
        // ********** 1. قوائم البيانات (500 كلمة و 200 جملة) **********
        // **********************************************

        const WORDS_GROUPS = {
            group_1: ["أَكَلَ", "شَرِبَ", "جَلَسَ", "دَرَسَ", "كَتَبَ", "لَعِبَ", "رَكَعَ", "سَجَدَ", "نَزَلَ", "صَعَدَ",
                      "فَتَحَ", "خَرَجَ", "طَبَخَ", "نَظَرَ", "سَأَلَ", "سَمِعَ", "قَرَأَ", "رَسَمَ", "نَجَحَ", "فَشِلَ",
                      "عَرَفَ", "ذَهَبَ", "عَادَ", "زَرَعَ", "حَصَدَ", "شَاهَدَ", "قَطَفَ", "بَنَى", "هَدَمَ", "صَنَعَ",
                      "طَلَبَ", "رَفَعَ", "وَضَعَ", "رَكِبَ", "نَامَ", "صَامَ", "قَامَ", "صَارَ", "مَاتَ", "بَكَى",
                      "ضَحِكَ", "جَمَعَ", "لَمَسَ", "أَخَذَ", "أَعْطَى", "أَرْسَلَ", "اسْتَمَعَ", "اِبْتَسَمَ", "غَضِبَ", "هَرَبَ"],
            
            group_2: ["أَبٌ", "أُمٌّ", "أَخٌ", "أُخْتٌ", "وَلَدٌ", "بِنْتٌ", "طِفْلٌ", "رَجُلٌ", "اِمْرَأَةٌ", "بَيْتٌ",
                      "غُرْفَةٌ", "بَابٌ", "نَافِذَةٌ", "كُرْسِيٌّ", "طَاوِلَةٌ", "كِتَابٌ", "قَلَمٌ", "دَفْتَرٌ", "وَرَقَةٌ", "صَفٌّ",
                      "مَكْتَبٌ", "مَدْرَسَةٌ", "مُعَلِّمٌ", "طَالِبٌ", "طَبِيبٌ", "نَجْمٌ", "قَمَرٌ", "شَمْسٌ", "بَحْرٌ", "نَهْرٌ",
                      "جَبَلٌ", "سَهْلٌ", "رِيحٌ", "مَطَرٌ", "نَارٌ", "مَاءٌ", "تُرَابٌ", "صُورَةٌ", "لَوْحَةٌ", "لَوْنٌ",
                      "حَجَرٌ", "ثَوْبٌ", "طَعَامٌ", "فَاكِهَةٌ", "خُضَارٌ", "خُبْزٌ", "لَحْمٌ", "سَمَكٌ", "شَجَرَةٌ", "وَرْدَةٌ"],

            group_3: ["حِصَانٌ", "زَرَافَةٌ", "بُسْتَانٌ", "دُيُورٌ", "فُصُولٌ", "عُيُونٌ", "أَيَادِي", "أَمَانَةٌ", "طَالِبٌ", "رَسُولٌ",
                      "عَامِلٌ", "صَائِمٌ", "قَارِئٌ", "سَمِيعٌ", "بَصِيرٌ", "كَبِيرٌ", "صَغِيرٌ", "جَمِيلٌ", "مَرِيضٌ", "جَائِعٌ",
                      "عَطْشَانٌ", "مَنَامُ", "يَسِيرُ", "نُزُولُ", "شُرُوقُ", "غُرُوبُ", "جُلُوسُ", "طَائِرٌ", "فَائِزٌ", "مَشْرُوبٌ",
                      "مَدِينَةٌ", "قُرْيَةٌ", "مِيزَانٌ", "سَاعَاتٌ", "دَقَائِقٌ", "ثَوَانِي", "كَنِيسَةٌ", "مَسْجِدٌ", "مُؤْمِنٌ", "صَادِقٌ",
                      "مُحَمَّدٌ", "إِبْرَاهِيمُ", "يُوسُفُ", "مُوسَى", "عِيسَى", "هَارُونُ", "إِسْمَاعِيلُ", "دَاوُودُ", "سُلَيْمَانُ", "صَفِيرُ"],

            group_4: ["سَمَكَةٌ", "طَائِرَةٌ", "مُهَنْدِسٌ", "مُعَلِّمَةٌ", "مَكْتَبَةٌ", "قَلَمًا", "كِتَابًا", "وَرَقَةٍ", "قَصَصٍ", "كُتُبٌ",
                      "السَّمَاءُ", "الشَّمْسُ", "النَّهَارُ", "اللَّيْلُ", "الْقَمَرُ", "الْأَرْضُ", "الْبَحْرُ", "الْجَبَلُ", "النَّاسُ", "الْحَيَاةُ",
                      "التُّفَّاحُ", "الشَّجَرَةُ", "الزَّرْعُ", "الْبَابُ", "الْكِتَابُ", "الْمَاءُ", "السُّكَّرُ", "الصَّبَاحُ", "الْمَسَاءُ", "الرَّبِيعُ",
                      "الصَّيْفُ", "الخَرِيفُ", "الشِّتَاءُ", "التَّدْرِيسُ", "الصِّحَّةُ", "المَرَضُ", "الصَّوْتُ", "الرِّيحُ", "السَّلَامُ", "الطَّرِيقُ",
                      "الشُّرْطَةُ", "المُسْتَشْفَى", "النِّظَافَةُ", "التِّلْمِيذُ", "الْمَلْعَبُ", "الْمَلِكُ", "الْحَقُّ", "الْوَاجِبُ", "الْبِدَايَةُ", "النِّهَايَةُ"],
            
            group_5: ["أَنَا", "نَحْنُ", "أَنْتَ", "أَنْتِ", "أَنْتُمَا", "أَنْتُمْ", "أَنْتُنَّ", "هُوَ", "هِيَ", "هُمَا", "هُمْ", "هُنَّ", 
                      "مِنْ", "إِلَى", "عَنْ", "عَلَى", "فِي", "البَاءِ", "الكَافِ", "اللَّامِ", "رُبَّ", "مُذْ", "مُنْذُ",
                      "هَذَا", "هَذِهِ", "هَؤُلَاءِ", "ذَلِكَ", "تِلْكَ", "أُولَئِكَ",
                      "الَّذِي", "الَّتِي", "الَّذَانِ", "الَّتَانِ", "الَّذِينَ", "اللَّاتِي", "مَنْ", "مَا",
                      "وَ", "فَ", "ثُمَّ", "أَوْ", "بَلْ", "لَكِنْ", "لا", "لَمْ", "لَنْ", "إِنْ"],

            group_6: ["وَاحِدٌ", "اِثْنَانِ", "ثَلَاثَةٌ", "أَرْبَعَةٌ", "خَمْسَةٌ", "سِتَّةٌ", "سَبْعَةٌ", "ثَمَانِيَةٌ", "تِسْعَةٌ", "عَشْرَةٌ",
                      "عِشْرُونَ", "ثَلَاثُونَ", "مِئَةٌ", "أَلْفٌ", "أَوَّلُ", "ثَانِي", "ثَالِثُ", "رَابِعُ", "خَامِسُ", "سَادِسُ",
                      "صِفْرٌ", "نِصْفٌ", "رُبْعٌ", "جُزْءٌ", "كُلٌّ", "بَعْضٌ", "كَمْ", "قَلِيلٌ", "كَثِيرٌ", "مُعْظَمُ",
                      "أَدْنَى", "أَقْصَى", "أَسْرَعُ", "أَبْطَأُ", "أَحْسَنُ", "أَجْمَلُ", "أَكْبَرُ", "أَصْغَرُ", "أَقْوَمُ", "أَعْلَى",
                      "أَطْوَلُ", "أَقْصَرُ", "أَغْلَى", "أَرْخَصُ", "أَبْيَضُ", "أَسْوَدُ", "أَحْمَرُ", "أَزْرَقُ", "أَخْضَرُ", "أَصْفَرُ"],

            group_7: ["سَعِيدٌ", "حَزِينٌ", "غَضْبَانُ", "مُتْعَبٌ", "نَشِيطٌ", "خَامِلٌ", "قَوِيٌّ", "ضَعِيفٌ", "مُبْتَسِمٌ", "بَاكٍ",
                      "جَدِيدٌ", "قَدِيمٌ", "صَادِقٌ", "كَاذِبٌ", "نَظِيفٌ", "وَسِخٌ", "حَارٌّ", "بَارِدٌ", "خَفِيفٌ", "ثَقِيلٌ",
                      "مُغْلَقٌ", "مَفْتُوحٌ", "مُمْتَلِئٌ", "فَارِغٌ", "هَادِئٌ", "صَاخِبٌ", "لَذِيذٌ", "مُرٌّ", "سَهْلٌ", "صَعْبٌ",
                      "كَرِيمٌ", "بَخِيلٌ", "ذَكِيٌّ", "غَبِيٌّ", "شُجَاعٌ", "جَبَانٌ", "حُلْوٌ", "مَالِحٌ", "طَوِيلٌ", "قَصِيرٌ",
                      "رَفِيعٌ", "عَرِيضٌ", "دَافِئٌ", "مُشْمِسٌ", "مُمْطِرٌ", "مُزْدَحِمٌ", "فَارِغٌ", "رَائِعٌ", "مُمِلٌّ", "عَمِيقٌ"],

            group_8: ["اليَوْمَ", "أَمْسِ", "غَدًا", "الآنَ", "قَبْلُ", "بَعْدُ", "سَابِقًا", "لَاحِقًا", "دَائِمًا", "أَبَدًا",
                      "أَحْيَانًا", "غَالِبًا", "صَبَاحًا", "مَسَاءً", "لَيْلًا", "نَهَارًا", "فَجْرًا", "ظُهْرًا", "عَصْرًا", "مَغْرِبًا",
                      "هُنَا", "هُنَاكَ", "أَمَامَ", "خَلْفَ", "فَوْقَ", "تَحْتَ", "يَمِينًا", "شِمَالًا", "دَاخِلَ", "خَارِجَ",
                      "قُرْبَ", "بُعْدَ", "جَانِبَ", "وَسْطَ", "حَوْلَ", "بَيْنَ", "أَيْنَمَا", "مَتَى", "كَيْفَ", "أَنَّى",
                      "حَيْثُ", "ثَمَّةَ", "مُبَكِّرًا", "مُتَأَخِّرًا", "مَعًا", "وَحْدِي", "فَجْأَةً", "سَرِيعًا", "بِهُدُوءٍ", "جَيِّدًا"],

            group_9: ["أُسْرَةٌ", "جَدٌّ", "جَدَّةٌ", "عَمٌّ", "عَمَّةٌ", "خَالٌ", "خَالَةٌ", "زَوْجٌ", "زَوْجَةٌ", "حَفِيدٌ",
                      "قَرِيبٌ", "ضَيْفٌ", "جَارٌ", "مُسَافِرٌ", "مُوَاطِنٌ", "صَدِيقٌ", "عَدُوٌّ", "مَلِكٌ", "رَئِيسٌ", "وَزِيرٌ",
                      "مُدِيرٌ", "مُهَنْدِسٌ", "فَلَّاحٌ", "نَجَّارٌ", "حَدَّادٌ", "خَبَّازٌ", "بَائِعٌ", "مُشْتَرٍ", "شُرْطِيٌّ", "جُنْدِيٌّ",
                      "قَاضٍ", "مُحَامٍ", "طَبَّاخٌ", "خَيَّاطٌ", "سَائِقٌ", "طَيَّارٌ", "بَحَّارٌ", "رَاعِي", "صَيَّادٌ", "مُمَرِّضٌ",
                      "سَاعِي", "عَامِلٌ", "رِيَاضِيٌّ", "مُغَنٍّ", "شَاعِرٌ", "فَنَّانٌ", "كَاتِبٌ", "رَسَّامٌ", "مُمَثِّلٌ", "قَصَّابٌ"],

            group_10: ["مَاذَا", "مَا", "مَنْ", "مَتَى", "أَيْنَ", "كَيْفَ", "كَمْ", "هَلْ", "لِمَاذَا", "أَلَا",
                       "نَعَمْ", "لَا", "حَسَنًا", "عَفْوًا", "شُكْرًا", "أَهْلًا", "مَرْحَبًا", "وَدَاعًا", "مَعَ", "بِدُونِ",
                       "إِلَّا", "فَقَطْ", "أيْضًا", "جِدًّا", "لِأَنَّ", "كَأَنَّ", "لَيْتَ", "لَعَلَّ", "عَسَى", "حَتَّى",
                       "قَدْ", "لَوْ", "إِذَا", "مَهْمَا", "حَيْثُمَا", "كُلَّمَا", "عِنْدَمَا", "بَيْنَمَا", "لِكَيْ", "كَيْ",
                       "لِئَلَّا", "وَإِنْ", "لَوْلَا", "أَمَّا", "إِمَّا", "أَيُّ", "مُعَيَّنٌ", "خَاصٌّ", "عَامٌّ", "مُخْتَلِفٌ"]
        };
        
        const ALL_WORDS = [].concat(...Object.values(WORDS_GROUPS));

        // ***** الجمل الجديدة (200 جملة) *****
        
        // المجموعة الأولى (100 جملة) - جمل قصيرة جداً (2-4 كلمات) وسهلة
        const SENTENCES_GROUP_1 = [
            "ذَهَبَ مُحَمَّدٌ إِلَى السُّوقِ.",
            "أَكَلَ خَالِدٌ التُّفَّاحَةَ.",
            "سَمِعَ أَحْمَدُ الْجَرَسَ.",
            "نَامَ الطِّفْلُ فِي السَّرِيرِ.",
            "قَرَأَتْ سَارَةُ كِتَابًا مُفِيدًا.",
            "كَتَبَ الْوَلَدُ وَاجِبَهُ.",
            "لَعِبَتْ هِنْدُ بِالْكُرَةِ.",
            "شَرِبَ الْقِطُّ اللَّبَنَ.",
            "فَتَحَ الْبَابَ بِهُدُوءٍ.",
            "أَغْلَقَ النَّافِذَةَ بِسُرْعَةٍ.",
            "رَكِبَ الْحِصَانَ الْأَبْيَضَ.",
            "نَزَلَ الْمَطَرُ غَزِيرًا.",
            "صَعِدَ الْجَبَلَ الْعَالِيَ.",
            "جَلَسَ الْجَدُّ عَلَى الْكُرْسِيِّ.",
            "وَقَفَ الْمُعَلِّمُ أَمَامَ الصَّفِّ.",
            "رَسَمَ الْفَنَّانُ صُورَةً.",
            "طَبَخَتْ أُمِّي طَعَامًا لَذِيذًا.",
            "غَسَلَ ثَوْبَهُ النَّظِيفَ.",
            "مَشَى الطَّائِرُ عَلَى الْأَرْضِ.",
            "طَارَتِ الْعَصَافِيرُ فِي السَّمَاءِ.",
            "زَارَ صَدِيقَهُ الْمَرِيضَ.",
            "عَادَ الْمُسَافِرُ إِلَى بَيْتِهِ.",
            "لَبِسَ قَمِيصًا جَدِيدًا.",
            "خَلَعَ حِذَاءَهُ فِي الْبَابِ.",
            "سَافَرْنَا بِالْقِطَارِ السَّرِيعِ.",
            "اِشْتَرَى الْخُبْزَ وَالْجُبْنَ.",
            "بَاعَ الْبَائِعُ الْفَوَاكِهَ.",
            "سَقَطَتْ وَرَقَةُ الشَّجَرَةِ.",
            "نَجَحَ الْجَمِيعُ فِي الِامْتِحَانِ.",
            "شَاهَدْنَا فِلْمًا قَدِيمًا.",
            "أَنَا طَالِبٌ نَشِيطٌ.",
            "أَنْتَ رَجُلٌ قَوِيٌّ.",
            "هِيَ بِنْتٌ جَمِيلَةٌ.",
            "هُمْ أَصْدِقَاءُ مُخْلِصُونَ.",
            "نَحْنُ نُحِبُّ الْقِرَاءَةَ.",
            "هَذَا بَيْتِي الْكَبِيرُ.",
            "تِلْكَ مَدْرَسَتِي الْقَدِيمَةُ.",
            "أَيْنَ الْقَلَمُ الْأَزْرَقُ؟",
            "مَتَى نَعُودُ إِلَى الْبَيْتِ؟",
            "كَمْ كِتَابًا قَرَأْتَ الْيَوْمَ؟",
            "هَلْ أَكَلْتَ طَعَامَكَ؟",
            "لِمَاذَا الْجَوُّ حَارٌّ الْيَوْمَ؟",
            "الشَّمْسُ سَاطِعَةٌ جِدًّا.",
            "الْقَمَرُ مُنِيرٌ فِي اللَّيْلِ.",
            "الْبَحْرُ وَاسِعٌ وَعَمِيقٌ.",
            "الْجَبَلُ شَامِخٌ وَمُرْتَفِعٌ.",
            "الْحَدِيقَةُ مَلِيئَةٌ بِالْوُرُودِ.",
            "الْكَلْبُ وَفِيٌّ لِصَاحِبِهِ.",
            "الْقِطُّ يَأْكُلُ السَّمَكَ.",
            "الْغُرْفَةُ مُنَظَّمَةٌ وَنَظِيفَةٌ.",
            "أَنَا أَغْسِلُ يَدَيَّ بِالصَّابُونِ.",
            "نَحْنُ نَشْرَبُ الْمَاءَ الْبَارِدَ.",
            "أَنْتِ تَلْعَبِينَ بِالْأَلْعَابِ.",
            "هُوَ يَدْرُسُ اللُّغَةَ الْعَرَبِيَّةَ.",
            "هِيَ تَطْبُخُ الْأَرُزَّ بِالْخَضْرَاوَاتِ.",
            "الْمُعَلِّمُ يَشْرَحُ الدَّرْسَ جَيِّدًا.",
            "الطَّالِبُ يَكْتُبُ الْجُمَلَ.",
            "الْعَامِلُ يَبْنِي الْجِدَارَ.",
            "الْفَلَّاحُ يَزْرَعُ الْأَرْضَ.",
            "أَبِي يَعْمَلُ فِي الْمَكْتَبِ.",
            "أُمِّي تُحِبُّنَا كَثِيرًا.",
            "أَخِي الْأَكْبَرُ يُسَاعِدُنِي.",
            "أُخْتِي الصَّغِيرَةُ تَبْكِي.",
            "الْجَدُّ يَحْكِي قِصَصًا جَمِيلَةً.",
            "الْجَدَّةُ تُعْطِينِي حَلْوَى.",
            "صَدِيقِي لَاعِبٌ مَاهِرٌ.",
            "جَارُنَا طَيِّبٌ وَكَرِيمٌ.",
            "نَذْهَبُ إِلَى الْمَسْجِدِ لِلصَّلَاةِ.",
            "نَزُورُ الْمَتْحَفَ فِي الْعُطْلَةِ.",
            "رَأَيْنَا الْأَسَدَ فِي الْحَدِيقَةِ.",
            "صَادَ الصَّيَّادُ سَمَكَةً كَبِيرَةً.",
            "الرِّيَاحُ قَوِيَّةٌ الْيَوْمَ.",
            "الْجَوُّ مُعْتَدِلٌ وَجَمِيلٌ.",
            "الْحَقِيبَةُ مَلِيئَةٌ بِالْكُتُبِ.",
            "الْقَلَمُ عَلَى الطَّاوِلَةِ.",
            "الْكُرْسِيُّ بِجَانِبِ النَّافِذَةِ.",
            "اِشْرَبِ الْعَصِيرَ الطَّازَجَ.",
            "كُلِ الْخُبْزَ الْأَسْمَرَ.",
            "اِفْتَحِ الْبَابَ بِرِفْقٍ.",
            "أَغْلِقِ الضَّوْءَ قَبْلَ النَّوْمِ.",
            "تَعَلَّمْنَا دَرْسًا جَدِيدًا.",
            "شَكَرْنَا الْمُعَلِّمَ عَلَى شَرْحِهِ.",
            "سَامَحْنَا صَدِيقَنَا عَلَى الْخَطَأِ.",
            "اِبْتَسَمَ لَنَا بِفَرَحٍ.",
            "غَضِبَ مِنْ سُلُوكِهِ السَّيِّئِ.",
            "نَادَى عَلَى أَخِيهِ بِصَوْتٍ عَالٍ.",
            "رَجَعَ إِلَيْنَا بَعْدَ مُدَّةٍ طَوِيلَةٍ.",
            "الْعَامِلُ تَعِبَ مِنْ الْعَمَلِ.",
            "النَّجَّارُ صَنَعَ طَاوِلَةً.",
            "الْحَدَّادُ ضَرَبَ الْمِسْمَارَ.",
            "الْبِنْتُ غَنَّتْ أُغْنِيَةً.",
            "الْوَلَدُ رَقَصَ بِسَعَادَةٍ.",
            "الْمُسْلِمُ صَامَ شَهْرَ رَمَضَانَ.",
            "الْحَيَاةُ جَمِيلَةٌ بِالْأَصْدِقَاءِ.",
            "الصِّحَّةُ أَغْلَى مِنْ الْمَالِ.",
            "الْوَقْتُ يَمْضِي سَرِيعًا.",
            "الْكَلَامُ الطَّيِّبُ صَدَقَةٌ.",
            "اِحْتَرِمْ وَالِدَيْكَ دَائِمًا.",
            "سَاعِدِ الْفُقَرَاءَ وَالْمَسَاكِينَ."
        ];

        // المجموعة الثانية (100 جملة) - جمل متوسطة وصعبة قليلاً
        const SENTENCES_GROUP_2 = [
            "شَاهَدَتْ هِيَ الْقَنَاةَ الْفَضَائِيَّةَ لَيْلًا.",
            "سَأَلَ الطَّالِبُ الْمُعَلِّمَ سُؤَالًا صَعْبًا.",
            "أُعْطِيَتْ الْجَائِزَةُ لِلْفَائِزِ الْأَوَّلِ.",
            "قَامَ الْجُنْدِيُّ بِوَاجِبِهِ بِشَجَاعَةٍ.",
            "صَارَتْ الْمَدِينَةُ أَكْثَرَ نُظْمًا وَجَمَالًا.",
            "رَأَى الْأَعْمَى ضَوْءَ الشَّمْسِ السَّاطِعِ.",
            "بَكَتْ الطِّفْلَةُ مِنْ شِدَّةِ الْجُوعِ وَالْبَرْدِ.",
            "ضَحِكَ الْجَمِيعُ عَلَى النُّكْتَةِ الْمُضْحِكَةِ.",
            "الْعُصْفُورُ يُغَنِّي فَوْقَ غُصْنِ الشَّجَرَةِ.",
            "الْقَمَرُ يَدُورُ حَوْلَ الْأَرْضِ بِانْتِظَامٍ.",
            "نَحْنُ نَحْتَفِلُ بِعِيدِ الْفِطْرِ الْمُبَارَكِ.",
            "سَيَذْهَبُونَ إِلَى الْمَكْتَبَةِ الْعَامَّةِ غَدًا.",
            "يَجِبُ أَنْ نَدْرُسَ بِجِدٍّ لِنَنْجَحَ.",
            "يُفَضِّلُ الْبَعْضُ شُرْبَ الْقَهْوَةِ صَبَاحًا.",
            "كُلُّ الْأَطْفَالِ يُحِبُّونَ اللَّعِبَ فِي الْهَوَاءِ الطَّلْقِ.",
            "أَنَا لَنْ أَتَأَخَّرَ عَنْ الْمَوْعِدِ أَبَدًا.",
            "لَا تَخَفْ مِنْ الْفَشَلِ، حَاوِلْ مُجَدَّدًا.",
            "مَا أَجْمَلَ هَذَا الْمَنْظَرَ الطَّبِيعِيَّ!",
            "الْعَمَلُ الْجَمَاعِيُّ يُحَقِّقُ النَّجَاحَ.",
            "الْكَرِيمُ يُعْطِي بِسَخَاءٍ وَلَا يَنْتَظِرُ شُكْرًا.",
            "الْحَيَاةُ تَعْلِيمٌ مُسْتَمِرٌّ لِلْإِنْسَانِ.",
            "الصِّدْقُ دَائِمًا يُؤَدِّي إِلَى الرَّاحَةِ.",
            "الْحُبُّ وَالتَّسَامُحُ أَسَاسُ الْعَلَاقَاتِ.",
            "كَيْفَ سَتَصِلُ إِلَى هَدَفِكَ الْكَبِيرِ؟",
            "عَلَيْنَا أَنْ نَحْفَظَ لُغَتَنَا الْعَرَبِيَّةَ.",
            "إِنَّهَا تَعْمَلُ فِي مَجَالِ الْهَنْدَسَةِ الْمَعْمَارِيَّةِ.",
            "الْمُهَنْدِسُ يَخْطُطُ لِلْبِنَاءِ بِدِقَّةٍ.",
            "الطَّائِرَاتُ تَطِيرُ عَالِيًا فَوْقَ السَّحَابِ.",
            "الْأَسْرَةُ تَجْتَمِعُ حَوْلَ الْمَائِدَةِ الْكَبِيرَةِ.",
            "نَحْنُ نَنْتَظِرُ قُدُومَ الْأَخْبَارِ السَّارَّةِ.",
            "قَدْ يَكُونُ الْغَدُ أَفْضَلَ مِنْ الْيَوْمِ.",
            "أَلَيْسَ الصُّبْحُ بِقَرِيبٍ جِدًّا؟",
            "سَوْفَ نَلْتَقِي بِالْأَصْدِقَاءِ فِي الْمُسْتَقْبَلِ.",
            "الْفَرَسُ الْعَرَبِيُّ سَرِيعٌ وَجَمِيلٌ.",
            "الْجَمَلُ يَسِيرُ فِي صَحْرَاءِ الرُّبْعِ الْخَالِي.",
            "يُمْكِنُكَ أَنْ تَفْعَلَ ذَلِكَ بِسُهُولَةٍ.",
            "لَيْسَ كُلُّ مَا يَلْمَعُ ذَهَبًا خَالِصًا.",
            "هُمْ لَمْ يَحْضُرُوا الِاجْتِمَاعَ الْهَامَّ.",
            "أَنَا أُفَضِّلُ الْجُلُوسَ تَحْتَ الشَّجَرَةِ.",
            "هِيَ تَعِيشُ فِي مَدِينَةٍ صَغِيرَةٍ وَهَادِئَةٍ.",
            "مَاذَا سَتَقُولُ لِلنَّاسِ فِي تِلْكَ اللَّحْظَةِ؟",
            "يَا لَيْتَنِي أَسْتَطِيعُ الطَّيَرَانَ مِثْلَ الْعُصْفُورِ.",
            "لَعَلَّ اللَّهَ يُحْدِثُ بَعْدَ ذَلِكَ أَمْرًا آخَرًا.",
            "إِذَا عَجَّلْتَ، فَاعْلَمْ أَنَّكَ سَتُخْطِئُ.",
            "كُلَّمَا اجْتَهَدْتَ، زَادَتْ فُرَصُ نَجَاحِكَ.",
            "مَهْمَا حَدَثَ، سَنَظَلُّ أَصْدِقَاءَ أَوْفِيَاءَ.",
            "الْمَالُ لَيْسَ كُلَّ شَيْءٍ فِي الْحَيَاةِ.",
            "يَجِبُ أَنْ نَتَعَاوَنَ عَلَى الْخَيْرِ دَائِمًا.",
            "الْمُسْتَقْبَلُ الْمُشْرِقُ يَنْتَظِرُنَا.",
            "العَاقِلُ مَنْ يَتَّعِظُ بِأَخْطَاءِ غَيْرِهِ.",
            "الصَّدَاقَةُ كَنْزٌ لَا يُقَدَّرُ بِثَمَنٍ.",
            "تَمْنَحُنِي الْقِرَاءَةُ سَعَادَةً عَظِيمَةً.",
            "الْكَوْنُ وَاسِعٌ وَمَلِيءٌ بِالْأَسْرَارِ.",
            "هَؤُلَاءِ الْأَطْفَالُ أَبْرِيَاءُ جِدًّا.",
            "هَذَا الْعَمَلُ صَعْبٌ وَلَكِنَّهُ مُهِمٌّ.",
            "عَائِلَتِي تَسْكُنُ فِي مَنْزِلٍ جَدِيدٍ.",
            "زَارَتْنَا خَالَتِي فِي الْأُسْبُوعِ الْمَاضِي.",
            "يَجِبُ عَلَيْنَا احْتِرَامُ الْكَبِيرِ.",
            "الْعُطْلَةُ الصَّيْفِيَّةُ طَوِيلَةٌ وَمُمْتِعَةٌ.",
            "سَيَأْتِي الْحَافِلَةُ فِي خَمْسِ دَقَائِقَ.",
            "الْخُيُولُ تَرْكُضُ فِي الْمَرَاعِي الْخَضْرَاءِ.",
            "لَمْ يَعُدْ أَحَدٌ مِنْ الرِّحْلَةِ بَعْدُ.",
            "قَدَّمَ الْعَامِلُ اسْتِقَالَتَهُ لِلْمُدِيرِ.",
            "أَنَا أُجِيدُ اللُّغَةَ الْإِنْجِلِيزِيَّةَ.",
            "هِيَ تَخَافُ مِنْ الظَّلَامِ فِي اللَّيْلِ.",
            "نَحْنُ نَفْتَقِدُ لِلْهُدُوءِ فِي الْعَاصِمَةِ.",
            "يُفَكِّرُ الْإِنْسَانُ بِعَقْلِهِ الْوَاعِي.",
            "الْأَطْفَالُ يَصْرُخُونَ بِفَرَحٍ فِي الْمَلْعَبِ.",
            "أَنْتُمْ مُوَظَّفُونَ مُجْتَهِدُونَ وَأَكْفَاءُ.",
            "هُمْ لَا يَسْتَسْلِمُونَ أَبَدًا لِلْيَأْسِ.",
            "عَادَ الْجَارُ مِنْ السَّفَرِ الْيَوْمَ.",
            "زَرَعَ الْفَلَّاحُ الْقَمْحَ فِي الشِّتَاءِ.",
            "لَا تَكُنْ أَنَانِيًّا فِي عَمَلِكَ.",
            "نَحْنُ نَأْكُلُ الْعَشَاءَ فِي السَّاعَةِ الثَّامِنَةِ.",
            "تَلْعَبُ الْبِنْتُ بِالدُّمْيَةِ الْجَدِيدَةِ.",
            "الطَّرِيقُ إِلَى الْقَرْيَةِ طَوِيلٌ.",
            "يُمْكِنُ أَنْ تَجِدَ الْحَلَّ بِمُفْرَدِكَ.",
            "اَلْقَاضِي أَصْدَرَ حُكْمَهُ الْعَادِلَ.",
            "الْمُحَامِي دَافَعَ عَنْ الْمُتَّهَمِ.",
            "سَائِقُ السَّيَّارَةِ كَانَ سَرِيعًا.",
            "الطَّيَّارُ قَادَ الطَّائِرَةَ بِأَمَانٍ.",
            "اَلْأَرْضُ تَدُورُ حَوْلَ الشَّمْسِ.",
            "الْكُتُبُ مَصْدَرُ الْمَعْرِفَةِ الْعَظِيمَةِ.",
            "الْحَيَاةُ مَلِيئَةٌ بِالتَّحَدِّيَاتِ الْمُخْتَلِفَةِ.",
            "تَحْتَاجُ إِلَى الْكَثِيرِ مِنْ الصَّبْرِ.",
            "لَوْ كُنْتُ مَكَانَكَ لَفَعَلْتُ الشَّيْءَ نَفْسَهُ.",
            "أَمَّا بَعْدُ، فَلْنَبْدَأْ الْعَمَلَ الْجَدِّيَّ.",
            "إِمَّا أَنْ تَفْعَلَ أَوْ تَتْرُكَ هَذَا الْأَمْرَ.",
            "لِئَلَّا تَنْسَى، دَوِّنْ مُلَاحَظَاتِكَ الْهَامَّةَ.",
            "إِنْ لَمْ تَعْمَلْ، فَلَنْ تَجِدَ طَعَامًا.",
            "لَنْ نَنْتَظِرَ أَحَدًا بَعْدَ الْيَوْمِ.",
            "رُبَّمَا نَلْتَقِي فِي الْمُسْتَقْبَلِ الْقَرِيبِ.",
            "عَسَى أَنْ يَأْتِيَ الْخَبَرُ السَّعِيدُ قَرِيبًا.",
            "لَوْلَا الْأَمَلُ لَمَاتَتْ الْقُلُوبُ حُزْنًا.",
            "الْقَاعَةُ مُزْدَحِمَةٌ بِالزَّائِرِينَ الْكُرَمَاءِ.",
            "الْمَكَانُ فَارِغٌ وَلَا يُوجَدُ فِيهِ أَحَدٌ.",
            "الْعَامُّ الْمَاضِي كَانَ سَنَةً صَعْبَةً.",
            "عِشْ حَيَاتَكَ بِسَعَادَةٍ وَاطْمِئْنَانٍ.",
            "يَا أَيُّهَا الرَّجُلُ، اتَّقِ اللَّهَ.",
            "كَيْفَ تَجْرُؤُ عَلَى قَوْلِ ذَلِكَ؟",
            "هَلْ هَذَا حَقِيقِيٌّ أَمْ مُجَرَّدُ كَلَامٍ؟"
        ];
        
        const ALL_SENTENCES = SENTENCES_GROUP_1.concat(SENTENCES_GROUP_2);
        
        const SENTENCES_GROUPS = {
            all_sentences: ALL_SENTENCES,
            sentences_group_1: SENTENCES_GROUP_1,
            sentences_group_2: SENTENCES_GROUP_2
        };

        // ********** نهاية قوائم البيانات **********

        // **********************************************
        // ********** 2. دالة تحويل الأرقام إلى عربية **********
        // **********************************************
        function convertToArabicNumbers(num) {
            const arabicNumbers = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
            return String(num).split('').map(digit => arabicNumbers[digit]).join('');
        }

        // **********************************************
        // ********** 3. متغيرات وعناصر التحكم **********
        // **********************************************

        let itemsArray;
        let currentItemIndex = 0;
        let intervalDuration = 5000; 
        let quizInterval;
        let selectedLevel = 'words'; 
        let maxItems = 500; 
        let selectedGroupKey = 'all_words'; 

        const setupScreen = document.getElementById('setup-screen');
        const quizDisplayDiv = document.getElementById('quiz-display');
        const currentItemElement = document.getElementById('current-item');
        const timerBar = document.getElementById('timer-bar');
        const quizTitle = document.getElementById('quiz-title');
        const timeDisplay = document.getElementById('time-display');
        const wordBox = document.querySelector('.word-box');
        const errorMessage = document.getElementById('error-message');
        const traineeNameInput = document.getElementById('trainee-name');
        const startIndexInput = document.getElementById('start-index');
        const maxIndexTip = document.getElementById('max-index-tip');
        const groupSelect = document.getElementById('group-select');
        const groupSelectLabel = document.getElementById('group-select-label');
        
        // حفظ خيارات الكلمات الأصلية
        const originalWordOptions = groupSelect.innerHTML;

        quizDisplayDiv.style.display = 'none'; 
        
        // **********************************************
        // ********** 4. دوال التحكم والتشغيل **********
        // **********************************************

        // 1. وظيفة تحديث المؤقت البصري (شريط التقدم)
        function startTimerBar(seconds) {
            timerBar.style.transition = 'none';
            timerBar.style.width = '100%';
            
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    timerBar.style.transition = `width ${seconds}s linear`;
                    timerBar.style.width = '0%';
                });
            });
        }
        
        // 2. وظيفة عرض العنصر التالي
        function displayNextItem() {
            if (itemsArray.length === 0) {
                currentItemElement.innerHTML = `<div class="item-segment">عفواً، القائمة فارغة.</div>`;
                clearInterval(quizInterval);
                return;
            }
            
            const itemNumber = currentItemIndex + 1;
            const arabicItemNumber = convertToArabicNumbers(itemNumber); // تحويل الرقم إلى عربي
            const itemContent = itemsArray[currentItemIndex];
            
            // التعديل الرئيسي: الترتيب هو [رقم عربي] ثم [الكلمة/الجملة] مع عكس اتجاه flex ليعرض الرقم في اليمين
            currentItemElement.innerHTML = `
                <div class="item-segment item-content">${itemContent}</div>
                <div class="item-segment item-number">${arabicItemNumber}</div>
            `;
            
            // ضبط حجم الخط حسب نوع العنصر
            document.querySelector('.item-content').style.fontSize = (selectedLevel === 'words') ? '70px' : '40px'; 
            document.querySelector('.item-number').style.fontSize = (selectedLevel === 'words') ? '70px' : '40px'; 

            startTimerBar(intervalDuration / 1000);
            
            currentItemIndex = (currentItemIndex + 1);
            if (currentItemIndex >= itemsArray.length) {
                currentItemIndex = 0; // العودة للبداية إذا انتهت القائمة
            }
        }

        // 3. وظيفة بدء التحدي الفعلي بعد التحقق
        function startQuiz() {
            setupScreen.style.display = 'none';
            quizDisplayDiv.style.display = 'block';

            if (quizInterval) {
                clearInterval(quizInterval);
            }

            // تحديد المصفوفة بناءً على المستوى والمجموعة المختارة
            if (selectedLevel === 'words') {
                itemsArray = (selectedGroupKey === 'all_words') ? ALL_WORDS : WORDS_GROUPS[selectedGroupKey];
            } else { // 'sentences'
                itemsArray = SENTENCES_GROUPS[selectedGroupKey];
            }

            const seconds = intervalDuration / 1000;
            const traineeName = traineeNameInput.value.trim();
            const startNum = parseInt(startIndexInput.value) || 1;
            
            let actualMax = itemsArray.length;
            currentItemIndex = (startNum > 0 && startNum <= actualMax) ? startNum - 1 : 0;
            
            // تحديث عنوان التحدي
            const levelText = selectedLevel === 'words' ? (groupSelect.options[groupSelect.selectedIndex].text) : (groupSelect.options[groupSelect.selectedIndex].text);
            quizTitle.innerHTML = `تحدي **${levelText}** للمتدرب: **${traineeName}**`;
            timeDisplay.textContent = seconds;
            
            // ضبط ألوان الشريط والحدود بناءً على نوع التحدي
            const color = (selectedLevel === 'words') ? '#ffc107' : '#34a853';
            const bgColor = (selectedLevel === 'words') ? '#fff9e6' : '#e6ffe6';
            
            timerBar.style.backgroundColor = color;
            wordBox.style.borderColor = color;
            wordBox.style.backgroundColor = bgColor;
            
            document.querySelector('.item-number').style.borderLeft = `3px solid ${color}`;

            displayNextItem();
            quizInterval = setInterval(displayNextItem, intervalDuration);
        }

        // 4. وظيفة التحقق والبدء (مربوطة بزر البدء)
        window.validateAndStartQuiz = function() {
            errorMessage.style.display = 'none';
            
            if (traineeNameInput.value.trim() === "") {
                errorMessage.textContent = "الرجاء كتابة اسم المتدرب قبل البدء.";
                errorMessage.style.display = 'block';
                return;
            }

            const startNum = parseInt(startIndexInput.value);
            let actualMax;
            if (selectedLevel === 'words') {
                actualMax = (selectedGroupKey === 'all_words') ? ALL_WORDS.length : WORDS_GROUPS[selectedGroupKey].length;
            } else { // 'sentences'
                actualMax = SENTENCES_GROUPS[selectedGroupKey].length;
            }

            if (isNaN(startNum) || startNum < 1 || startNum > actualMax) {
                errorMessage.textContent = `رقم البدء غير صحيح. يجب أن يكون بين 1 و ${actualMax} ضمن هذه المجموعة.`;
                errorMessage.style.display = 'block';
                return;
            }

            startQuiz();
        }

        // 5. وظيفة التحكم باختيار المستوى والوقت
        document.addEventListener('DOMContentLoaded', () => {
            const levelButtons = document.querySelectorAll('#level-selection-group button');
            const durationButtons = document.querySelectorAll('#duration-selection-group button');

            // وظيفة تحديث خيارات المجموعة (Group Select)
            function updateGroupOptions(level) {
                groupSelect.innerHTML = '';
                if (level === 'words') {
                    groupSelectLabel.textContent = 'اختيار المجموعة:';
                    groupSelect.innerHTML = originalWordOptions;
                    maxIndexTip.textContent = `(الحد الأقصى: 500)`;
                    startIndexInput.max = 500;
                    selectedGroupKey = 'all_words';

                } else { // 'sentences'
                    groupSelectLabel.textContent = 'اختيار مجموعة الجمل:';
                    groupSelect.innerHTML = `
                        <option value="all_sentences">جميع الجمل (200 جملة)</option>
                        <option value="sentences_group_1">المجموعة 1: جمل بسيطة جداً (100 جملة)</option>
                        <option value="sentences_group_2">المجموعة 2: جمل متوسطة/صعبة (100 جملة)</option>
                    `;
                    maxIndexTip.textContent = `(الحد الأقصى: 200)`;
                    startIndexInput.max = 200;
                    selectedGroupKey = 'all_sentences';
                }
                 startIndexInput.value = 1; 
            }

            levelButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    levelButtons.forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    selectedLevel = this.dataset.level;
                    maxItems = parseInt(this.dataset.max);
                    
                    updateGroupOptions(selectedLevel);
                });
            });
            
            groupSelect.addEventListener('change', function() {
                selectedGroupKey = this.value;
                let newMax;
                
                if (selectedLevel === 'words') {
                    newMax = (selectedGroupKey === 'all_words') ? ALL_WORDS.length : WORDS_GROUPS[selectedGroupKey].length;
                } else { // 'sentences'
                    newMax = SENTENCES_GROUPS[selectedGroupKey].length;
                }

                maxIndexTip.textContent = `(الحد الأقصى: ${newMax})`;
                startIndexInput.max = newMax;
                
                if (parseInt(startIndexInput.value) > newMax) {
                    startIndexInput.value = 1;
                }
            });

            durationButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    durationButtons.forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    intervalDuration = parseInt(this.dataset.duration);
                });
            });
            
            // تهيئة الخيارات عند التحميل
            updateGroupOptions('words'); 
        });

    </script>
</body>
</html>
